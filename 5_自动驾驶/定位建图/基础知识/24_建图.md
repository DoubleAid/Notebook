# 建图

## 主要目标

1. 理解单目SLAM中稠密深度估计的原理
2. 通过实验了解单目稠密重建的过程
3. 了解集中RGB-D重建中的地图形式

## 概述

建图 Mapping 

我们之前只讨论了定位和后端优化，接下来将建图

在经典SLAM中，我们所谓的地图就是所有路标点的集合。一旦确定好了路标点的位置，就可以说我们完成了建图。于是，前面的视觉里程计也好，BA也好，事实上都建模了路标点的位置，并对他们进行优化。为什么现在还要讲建图呢

因为人们对建图的需求是不同的，SLAM作为一种底层技术，往往是为上层应用提供信息的，应用层的开发者希望使用SLAM来做全局的定位，并且让机器人在地图中导航

在SLAM来看，建图是服务于定位的，但是从应用层来看，建图还有其他需求

1. 定位；定位是地图的一项基本功能；我们能够把地图保存下来，不必每一次都对地图进行一次建模
2. 导航：可以在地图点上虚招路径，控制自己运动到目标点的过程，我们至少要知道地图中哪些地方不可通过，哪些可以通过，这种我们需要另外一种地图形式 --- 稠密地图
3. 避障：避障更注重局部的，动态的障碍物的处理，同样的，仅有特征点无法判断某个特征点是否为障碍物，需要稠密建图
4. 重建：我们希望利用SLAM获得周围环境的重建效果 --- 这种地图也是稠密的
5. 交互：比如我们在VR中放置了一些物品，框选一些物品等，除了环境地图之外，机器人还需要知道哪一块地图是桌子，识别一些物品，这需要机器人对地图有更高层次的认知 --- 也称为语义地图

上面所说的地图类型

+ 稀疏路标地图：只建模感兴趣的部分，也就是特征点或路标点
+ 稠密地图：建模所有见过的部分

## 单目稠密重建

视觉SLAM的稠密重建问题是本讲的第一个重要话题。单个图片的像素只能提供物体在成像平面的角度，但无法提供物体的距离。在稠密建图中，我们需要知道每一个像素的位置信息，大致上有以下解决方案

+ 使用单目相机，通过移动相机之后进行三角化测量像素的距离
+ 使用双目相机，利用左右目的视差计算像素的距离
+ 使用RGB-D相机直接获得像素距离

前两种方式称为立体视觉 （stereo vision）其中移动单目的又称为移动视角的立体视觉（Moving View Stereo）。相比于RGB-D直接测量的深度，单目和双目对深度的获取往往费力不讨好，我们进行了大量的计算，但是得到的深度估计却不怎么可靠

1. 首先，我们对图像提取特征，并根据描述子计算了特征之间的匹配
