# 时间同步

时间同步的核心目的是将不同传感器（如激光雷达、IMU、相机）在同一物理时刻采集的数据对齐到同一时间基准，确保多源数据描述的是同一环境状态，为后续融合（如位姿估计、特征匹配）提供一致的输入，避免因时间偏差导致的融合精度下降或算法失效。

## 一、时间同步的核心目的

1. 保证数据的 “时空一致性”：不同传感器的采样频率、启动时间可能不同（如 IMU 1000Hz、激光雷达 10Hz、相机 30Hz），时间同步能让各传感器数据对应同一物理时刻的场景，确保融合时使用的是 “同一帧” 环境信息。
2. 消除运动畸变误差：激光雷达、相机等传感器采样过程中，载体（如机器人）可能存在运动，若数据不同步，会导致同一传感器的单帧数据对应不同时刻的运动状态（如激光点云畸变），或多传感器数据反映的运动状态不一致。
3. 保障融合算法有效性：多传感器融合（如 LIO、VIO）依赖多源数据的约束关系（如 IMU 的运动预测辅助激光配准），时间偏差会破坏这种约束，导致优化结果漂移或收敛失败。

## 二、工程中常用的时间同步方法

### 硬件同步（高精度首选）

+ 核心原理：通过硬件信号（如脉冲、触发信号）统一触发多个传感器采样，确保所有传感器在同一硬件触发信号下同步采集数据，时间偏差可控制在微秒级。

### 软件时间戳对齐（通用性强）

各传感器独立采样并记录自身时间戳（基于传感器内部时钟），通过软件算法将所有传感器的时间戳映射到同一全局时间基准（如系统时钟、GPS 时间）。

### PTP时钟同步

## 三、时间戳偏差的处理方法

### 1. 固定偏差（系统误差）

表现：两个传感器的时间戳差值始终为一个固定值（如相机时间戳比激光雷达始终晚 20ms），由传感器启动延迟、硬件触发延迟等导致。

+ 处理方法：
  + 标定固定偏差：通过静态场景采集多组数据，计算两传感器时间戳的平均差值，作为固定偏差值。
  + 实时补偿：在数据预处理阶段，对其中一个传感器的时间戳加上 / 减去固定偏差值，直接对齐到另一传感器的时间基准。
  + 示例：若相机时间戳 = 激光雷达时间戳 - 20ms，则将相机所有时间戳 +20ms，实现与激光雷达时间同步
