# RANSAC 算法流程

RANSAC（Random Sample Consensus，随机抽样一致性）是一种鲁棒的参数估计算法，核心目标是从包含大量异常数据（外点）的样本集中，估计出最优的模型参数，广泛用于点云配准、特征匹配、相机标定等 SLAM 任务。

超参数

1. 迭代次数 N：算法最大迭代次数（由置信度和内点比例估算）；
2. 阈值 $\varepsilon$：点对的投影误差阈值（判断内点 / 外点的依据）；
3. 置信度 p：最终模型包含正确内点的概率（通常设 95%~99%）；
4. 最小采样数 k：拟合模型所需的最少点对数量（刚性变换需 3 对不共线点）。

输入数据包含：

+ 内点（inliers，符合模型）和外点（outliers，噪声）的观测数据
+ 模型类型：需要拟合的数学模型（如直线、平面、单应性矩阵等）
+ 最小样本数：拟合模型所需的最少数据点数 k, 比如直线2
+ 置信度 p：最终模型包含正确内点的概率（通常设 95%~99%）；

步骤

1. 初始化最优变换矩阵 $T_{best}$ 为空，初始化最大内点数量 $count_{best}=0$。
2. 从匹配点对集合 S 中，随机抽取 k 个数据
3. 用这 k 个样本数据，求解模型参数；
4. 计算全局误差，筛选内点
5. 统计内殿数量，更新最有模型，判定停止条件

## 补充

1. 迭代次数 N 的估算公式

不需要手动设定固定值，可通过置信度计算理论最小迭代次数：

$$
N = \frac{\log(1-p)}{\log(1-w^k)}
$$

其中 w 是内点占总样本的比例。例如：置信度 $p=99\%$，内点比例 $w=50\%$，$k=3$，则 $N\approx 130$ 次。

2. 核心优势与局限性
    + 优势：对异常值（外点）鲁棒性极强，能在大量外点中精准估计模型；
    + 局限性：结果是概率性的（无法保证 100% 找到最优模型）；超参数（阈值 $\varepsilon$、迭代次数 N）的设置依赖经验。

3. 在 SLAM 中的典型应用
    + 激光点云配准：结合 FPFH 特征匹配，用 RANSAC 剔除错误匹配对，求解初始变换矩阵；
    + 视觉特征匹配：剔除误匹配的 ORB/SIFT 特征点对，估计本质矩阵 / 基础矩阵。

