# LeGO-LOAM 流程介绍

LeGO-LOAM 继承了 LOAM “高频里程计 + 低频建图” 的双线程解耦框架，但在预处理、特征提取、配准策略上做了针对性优化，输入为 3D 激光点云，输出为机器人位姿和全局地图。

## 步骤 1：点云分割与地面提取（LeGO-LOAM 独创核心步骤）

这是 LeGO-LOAM 与 LOAM 最关键的区别 ——先分割地面，再提取特征，而非直接对全点云提取特征。

1. 扫描线分组：将 3D 激光点云按垂直角度分组（如 16 线雷达分为 16 组扫描线）；
2. 地面点筛选：假设地面是连续平面，利用激光雷达的垂直角度约束筛选地面点：
    + 取垂直角度接近水平的扫描线（如 -15°~0°），这些线的点大概率是地面；
    + 用 RANSAC 拟合地面平面方程 \(ax+by+cz+d=0\)；
    + 计算所有点到地面平面的距离，距离小于阈值的判定为地面点，其余为非地面点；
    + 地面点去畸变：对地面点单独做运动畸变去除（地面结构稳定，去畸变精度更高）。

## 步骤 2：特征提取（分地面 / 非地面特征）

LeGO-LOAM 同样提取边缘点 + 平面点，但只对非地面点提取特征，地面点直接用于后续配准约束，大幅减少特征提取的计算量。

非地面点特征提取：

+ 曲率计算：沿用 LOAM 的曲率公式 \(c_i = \frac{1}{N}\sum_{j\in\mathcal{N}(i)} \|p_j - \bar{p}\|^2\)；
+ 特征筛选：高曲率为边缘点，低曲率为平面点，每帧仅提取 100 个边缘点 + 100 个平面点（比 LOAM 少 50%）；
+ 地面点约束构建：地面点直接作为平面约束，无需额外拟合，进一步降低计算量。

## 3. 关键帧机制（没有滑动窗口）

不处理每一帧，只选关键帧处理
选择标准：移动够远（>1米）或转动够大（>10度）
作用：减少计算，为回环检测打基础

## 位姿图全局优化 初始的LeGO-LOAM不带全局优化，后面加的

每个关键帧是一个“节点”
帧间运动是“边”（约束）
用图优化工具(g2o)全局调整所有位姿
消除局部累积误差

## 回环检测系统 初始的LeGO-LOAM不带全局优化，后面加的

检测流程：

用Scan Context描述子快速匹配候选帧
用ICP精配准几何验证
确认后添加“回环边”到图中
触发全局优化，校正漂移
效果：让系统能跑长距离而不“跑偏”。
